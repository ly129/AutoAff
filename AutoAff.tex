\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{ifthen}
\usepackage{amsmath}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{set.seed}\hlstd{(}\hlnum{29010719}\hlstd{)}
\hlstd{names} \hlkwb{<-} \hlkwd{c}\hlstd{(LETTERS, letters)}
\hlstd{n} \hlkwb{<-} \hlkwd{length}\hlstd{(names)}
\hlstd{aff} \hlkwb{<-} \hlkwd{sapply}\hlstd{(names,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)\{}\hlkwd{paste}\hlstd{(}\hlstr{"U"}\hlstd{, x,} \hlkwc{sep} \hlstd{=} \hlstr{""}\hlstd{)\})}

\hlstd{a} \hlkwb{<-} \hlkwd{as.character}\hlstd{(}\hlkwd{sample}\hlstd{(aff, n,} \hlkwc{replace} \hlstd{=} \hlnum{TRUE}\hlstd{))}
\hlstd{b} \hlkwb{<-} \hlkwd{as.character}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{sample}\hlstd{(aff, n} \hlopt{-} \hlnum{8}\hlstd{,} \hlkwc{replace} \hlstd{=} \hlnum{TRUE}\hlstd{),} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{,} \hlnum{8}\hlstd{)))}
\hlstd{c} \hlkwb{<-} \hlkwd{as.character}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{sample}\hlstd{(aff, n} \hlopt{-} \hlnum{20}\hlstd{,} \hlkwc{replace} \hlstd{=} \hlnum{TRUE}\hlstd{),} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{,} \hlnum{20}\hlstd{)))}

\hlstd{data} \hlkwb{<-} \hlkwd{data.frame}\hlstd{(names, a, b, c)}


\hlkwa{for} \hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{32}\hlstd{) \{}
  \hlkwa{if} \hlstd{(data[i,}\hlnum{1}\hlstd{]} \hlopt{==} \hlstd{data[i,}\hlnum{2}\hlstd{]} \hlopt{|} \hlstd{data[i,}\hlnum{1}\hlstd{]} \hlopt{==} \hlstd{data[i,}\hlnum{3}\hlstd{]} \hlopt{|} \hlstd{data[i,}\hlnum{2}\hlstd{]} \hlopt{==} \hlstd{data[i,}\hlnum{3}\hlstd{]) \{}
    \hlkwd{print}\hlstd{(i)}
  \hlstd{\}}
\hlstd{\}}
\end{alltt}
\begin{verbatim}
## [1] 11
\end{verbatim}
\begin{alltt}
\hlkwa{for} \hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlnum{44}\hlstd{) \{}
  \hlkwa{if} \hlstd{(data[i,}\hlnum{1}\hlstd{]} \hlopt{==} \hlstd{data[i,}\hlnum{2}\hlstd{]) \{}
    \hlkwd{print}\hlstd{(i)}
  \hlstd{\}}
\hlstd{\}}

\hlstd{data[}\hlnum{11}\hlstd{,} \hlnum{3}\hlstd{]} \hlkwb{=} \hlstr{"UZ"}
\hlstd{data} \hlkwb{<-} \hlstd{data[}\hlkwd{sample}\hlstd{(}\hlnum{1}\hlopt{:}\hlstd{n), ]}

\hlstd{AutoAff} \hlkwb{<-} \hlkwa{function}\hlstd{(}\hlkwc{X}\hlstd{,} \hlkwc{aff1}\hlstd{,} \hlkwc{aff2}\hlstd{,} \hlkwc{aff3}\hlstd{) \{}
  \hlstd{mat} \hlkwb{<-} \hlkwd{as.matrix}\hlstd{(X[,} \hlkwd{c}\hlstd{(aff1, aff2, aff3)])}
  \hlstd{aff} \hlkwb{<-} \hlkwd{na.exclude}\hlstd{(}\hlkwd{unique}\hlstd{(}\hlkwd{as.character}\hlstd{(}\hlkwd{as.vector}\hlstd{(}\hlkwd{t}\hlstd{(mat)))))}
  \hlstd{n.aff} \hlkwb{<-} \hlkwd{length}\hlstd{(aff)}
  \hlstd{aff} \hlkwb{<-} \hlstd{aff[}\hlnum{1}\hlopt{:}\hlstd{n.aff]}

  \hlkwa{for} \hlstd{(i} \hlkwa{in} \hlnum{1}\hlopt{:}\hlkwd{dim}\hlstd{(X)[}\hlnum{1}\hlstd{]) \{}
    \hlstd{aa} \hlkwb{<-} \hlkwd{which}\hlstd{(aff} \hlopt{==} \hlstd{mat[i,} \hlnum{1}\hlstd{])}
    \hlstd{bb} \hlkwb{<-} \hlkwd{which}\hlstd{(aff} \hlopt{==} \hlstd{mat[i,} \hlnum{2}\hlstd{])}
    \hlstd{cc} \hlkwb{<-} \hlkwd{which}\hlstd{(aff} \hlopt{==} \hlstd{mat[i,} \hlnum{3}\hlstd{])}
    \hlkwa{if} \hlstd{(}\hlkwd{length}\hlstd{(bb)} \hlopt{!=} \hlnum{0}\hlstd{)\{}
      \hlkwa{if} \hlstd{(}\hlkwd{length}\hlstd{(cc)} \hlopt{==} \hlnum{0}\hlstd{) \{}
        \hlstd{mat[i,} \hlnum{1}\hlstd{]} \hlkwb{<-} \hlstd{aff[}\hlkwd{min}\hlstd{(}\hlkwd{c}\hlstd{(aa, bb))]}
        \hlstd{mat[i,} \hlnum{2}\hlstd{]} \hlkwb{<-} \hlstd{aff[}\hlkwd{max}\hlstd{(}\hlkwd{c}\hlstd{(aa, bb))]}
      \hlstd{\}}
      \hlkwa{if} \hlstd{(}\hlkwd{length}\hlstd{(cc)} \hlopt{!=} \hlnum{0}\hlstd{) \{}
        \hlstd{order} \hlkwb{<-} \hlkwd{sort}\hlstd{(}\hlkwd{c}\hlstd{(aa, bb, cc))}
        \hlstd{mat[i,} \hlnum{1}\hlstd{]} \hlkwb{<-} \hlstd{aff[order[}\hlnum{1}\hlstd{]]}
        \hlstd{mat[i,} \hlnum{2}\hlstd{]} \hlkwb{<-} \hlstd{aff[order[}\hlnum{2}\hlstd{]]}
        \hlstd{mat[i,} \hlnum{3}\hlstd{]} \hlkwb{<-} \hlstd{aff[order[}\hlnum{3}\hlstd{]]}
      \hlstd{\}}
    \hlstd{\}}
  \hlstd{\}}

  \hlstd{data[, aff1]} \hlkwb{<-} \hlstd{mat[,} \hlnum{1}\hlstd{]}
  \hlstd{data[, aff2]} \hlkwb{<-} \hlstd{mat[,} \hlnum{2}\hlstd{]}
  \hlstd{data[, aff3]} \hlkwb{<-} \hlstd{mat[,} \hlnum{3}\hlstd{]}

  \hlkwd{return}\hlstd{(}\hlkwd{list}\hlstd{(}\hlkwc{affilliations} \hlstd{= aff,} \hlkwc{count} \hlstd{= n.aff,} \hlkwc{data} \hlstd{= data))}
\hlstd{\}}

\hlstd{result} \hlkwb{<-} \hlkwd{AutoAff}\hlstd{(data,} \hlstr{"a"}\hlstd{,} \hlstr{"b"}\hlstd{,} \hlstr{"c"}\hlstd{)}
\hlstd{data} \hlkwb{<-} \hlstd{result}\hlopt{$}\hlstd{data}
\end{alltt}
\end{kframe}
\end{knitrout}

j\textsuperscript{1, 2, },
h\textsuperscript{3, 4, },
t\textsuperscript{5, , },
M\textsuperscript{6, 7, 8},
r\textsuperscript{9, 10, },
U\textsuperscript{7, 9, 11},
b\textsuperscript{12, 13, 14},
F\textsuperscript{15, 16, 17},
v\textsuperscript{10, , },
a\textsuperscript{6, 14, 18},
E\textsuperscript{8, 18, 19},
O\textsuperscript{8, 12, 20},
Z\textsuperscript{21, 22, 23},
p\textsuperscript{15, 19, },
V\textsuperscript{10, 24, 25},
B\textsuperscript{1, 21, 26},
d\textsuperscript{27, 28, 29},
e\textsuperscript{10, 26, 30},
f\textsuperscript{4, 10, 19},
W\textsuperscript{1, 19, 28},
N\textsuperscript{7, 9, 10},
S\textsuperscript{9, 12, 31},
q\textsuperscript{27, 32, },
w\textsuperscript{4, , },
G\textsuperscript{7, 22, 33},
c\textsuperscript{14, 21, 30},
n\textsuperscript{14, 20, },
g\textsuperscript{2, 23, },
R\textsuperscript{7, 24, 26},
k\textsuperscript{17, 34, },
X\textsuperscript{19, 34, 35},
Q\textsuperscript{12, 17, 36},
y\textsuperscript{37, , },
D\textsuperscript{13, 17, 24},
x\textsuperscript{4, , },
s\textsuperscript{38, , },
m\textsuperscript{22, 38, },
z\textsuperscript{39, , },
A\textsuperscript{10, 40, 41},
L\textsuperscript{10, 12, 42},
o\textsuperscript{27, 43, },
l\textsuperscript{1, 44, },
I\textsuperscript{8, 21, 45},
u\textsuperscript{7, , },
Y\textsuperscript{15, 32, 46},
H\textsuperscript{15, 34, 35},
i\textsuperscript{5, 32, },
C\textsuperscript{1, 2, 18},
T\textsuperscript{12, 18, 33},
J\textsuperscript{3, 16, 16},
K\textsuperscript{9, 28, 38},
P\textsuperscript{7, 18, 25},
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },
NA\textsuperscript{, , },



\end{document}
